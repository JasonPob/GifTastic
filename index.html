<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GifTastic || Jason Poblador</title>
</head>

<body>
    <h1>Food GIF Generator!!</h1>
    <!-- place buttons here -->
    <div id="buttonsView"></div>
    <br>
    <br>
    <!-- GIFS will be placed here -->
    <div id="GIFS"></div>
    <!-- button generator form -->
    <div id="buttonGenerator">
        <form id="buttons">
            <label for="buttonInput">Add a Food!</label>
            <input type="text" id="buttonInput"><br><br>

            <input id="add-food" type="submit" value="Add a Food!">
        </form>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
        //Tasks
        //1. Initial array of food
        //2. Dynamically create buttons
        //3. Link buttons to GIPHY API
        //4. Show 10 GIF's per button and display picture and rating


        //Initial array of foods
        var foods = ["Bacon", "Tacos", "Burgers", "Pancakes", "Sushi", "Pizza", "Pasta", "Grilled Cheese", "Donuts"]

        function renderButtons() {
            //empty buttons array before adding updated list
            $("#buttonsView").empty();
            //create buttons in food array
            for (var i = 0; i < foods.length; i++) {
                var a = $("<button>");
                a.addClass("foods");
                a.attr("data-name", foods[i]);
                a.text(foods[i]);
                //add button to HTML
                $("#buttonsView").append(a);
            }
        }

        //adding buttons to existing list
        $("#add-food").on("click", function (event) {
            event.preventDefault();
          
            //grab line from input box
            var food = $("#buttonInput").val().trim();
            //add food to foods array
            foods.push(food);
            renderButtons();
        });



        //Adding click event listen listener to all buttons
        $("#add-food").on("click", function () {
            //prevent form from submitting itself
            event.preventDefault();
            //empty buttons before adding the updated list
            $("#buttonsView").empty();
            //use data-search attr on click event
            var x = $(this).data("search");
            //make queryURL and pull 10 results using data-search
            var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + x + "&api_key=E2JXP2YQb0vQRJcPrNRHyq54ZXyEwH3K&limit=10";
            //AJAX call
            $.ajax({ url: queryURL, method: "GET" })
                .done(function (response) {
                    console.log(response);
                    for (var i = 0; i < response.data.length; i++) {
                        var foodDiv = $("<div>");
                        var p = $("<p>").text("Rating: " + response.data[i].rating);
                        var foodImage = $("<img>");
                        foodImage.attr("data-name", foods[i]);
                        foodImage.attr("src", response.data[i].images.fixed_height.url);
                        foodDiv.append(p);
                        foodDiv.append(foodImage);
                        $("#GIFS").append(foodDiv);
                    }
                })

        });

        renderButtons();



    </script>
</body>

</html>